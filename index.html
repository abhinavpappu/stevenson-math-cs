<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <link href="https://fonts.googleapis.com/css?family=Roboto|Open+Sans" rel="stylesheet">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <title>Stevenson Math and CS</title>
    <style>
    html, body {
      margin: 0;
      padding: 0;
      font-family:"Roboto", "Open Sans", sans-serif;
    }

    .hr {
      height: 1px;
      width: 100%;
      background-color: black;
    }

    .templates, .hide {
      display: none;
    }

    .ripple-enabled {
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }

    .ripple-gray .ripple, .ripple-grey .ripple {
      background-color: gray;
    }

    .ripple {
      background-color: white;
      opacity: .4;
      height: 8px;
      width: 8px;
      border-radius: 6px;
      transition: transform .3s, opacity .3s;
      position: absolute;
    }

    .indigo {background-color: #303F9F}
    .red {background-color: #F44336}
    .purple {background-color: #673AB7}
    .blue {background-color: #1E88E5}
    .teal {background-color: #009688}
    .green {background-color: #43A047}
    .orange {background-color: #F57C00}
    .indigo-text {color: #303f9f}
    .red-text {color: #F44336}
    .purple-text {color: #673AB7}
    .blue-text {color: #1E88E5}
    .teal-text {color: #009688}
    .green-text {color: #43A047}
    .orange-text {color: #F57C00}

    #head {
      padding: 100px;
      cursor: pointer;
    }

    #head .text {
      max-width: 1000px;
      margin: auto;
      font-size: 2.5em;
      letter-spacing: 1.5px;
      color: white;
    }

    #loading-bar {
      position: relative;
      overflow: hidden;
      display: none;
      height: 5px;
      width: 100%;
    }

    #loading-bar .bg, #loading-bar .bar-container, #loading-bar .bar{
      position: absolute;
      height: 100%;
      width: 100%;
    }

    #loading-bar .bg {
      opacity: .5;
    }

    #loading-bar .bar-container.first{
      left: -55%;
    }

    #loading-bar .bar-container.second {
      left: -145%;
    }

    .loading-translate-1 {animation: translate-1 2s infinite linear}
    .loading-translate-2 {animation: translate-2 2s infinite linear}
    .loading-scale-1 {animation: scale-1 2s infinite linear}
    .loading-scale-2 {animation: scale-2 2s infinite linear}

    @keyframes translate-1 {
      0% {
        animation-timing-function: cubic-bezier(.15, 0, .515, .41);
        transform: translateX(0)
      }
      25% {
        animation-timing-function: cubic-bezier(.31, .284, .8, .734);
        transform: translateX(38%)
      }
      48.35% {
        animation-timing-function: cubic-bezier(.4, .627, .6, .902);
        transform: translateX(84%)
      }
      100% {
        transform: translateX(160%)
      }
    }

    @keyframes translate-2 {
      0% {
        transform: translateX(0)
      }
      20% {
        animation-timing-function: cubic-bezier(.5, 0, .702, .496);
        transform: translateX(0)
      }
      59.15% {
        animation-timing-function: cubic-bezier(.302, .381, .55, .956);
        transform: translateX(84%)
      }
      100% {
        transform: translateX(200%)
      }
    }

    @keyframes scale-1 {
      0% {
        animation-timing-function: cubic-bezier(.15, 0, .515, .41);
        transform: scaleX(.08)
      }
      19.15% {
        animation-timing-function: cubic-bezier(.31, .284, .8, .734);
        transform: scaleX(.457)
      }
      44.15% {
        animation-timing-function: cubic-bezier(.4, .627, .6, .902);
        transform: scaleX(.728)
      }
      100% {
        transform: scaleX(.08)
      }
    }

    @keyframes scale-2 {
      0% {
        transform: scaleX(.08)
      }
      36.65% {
        animation-timing-function: cubic-bezier(.335, .125, .785, 1);
        transform: scaleX(.08)
      }
      69.15% {
        animation-timing-function: cubic-bezier(.06, .11, .6, 1);
        transform: scaleX(.661)
      }
      100% {
        transform: scaleX(.08)
      }
    }

    .teacher-card {
      box-shadow: 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12);
      background-color: white;
      display: inline-block;
      border-radius: 2px;
      position: absolute;
    }

    .teacher-card .container {
      margin: 20px;
      visibility: hidden;
      width: 210px;
    }

    .teacher-card .image {
      background-size: cover;
      height: 90px;
      width: 90px;
      border-radius: 45px;
      margin: 0 auto 5px auto;
    }

    .teacher-card .name {
      text-align: center;
      font-size: 1.1em;
      margin-bottom: 10px;
    }

    .teacher-card .course-names {
      font-size: .8em;
      text-align: center;
      opacity: .75;
      margin-bottom: 15px;
    }

    .teacher-card .contact {
      text-decoration: none;
      color: black;
      display: block;
      padding: 6px;
      border-radius: 100px;
    }

    .teacher-card .contact i {
      font-size: 1.2em;
    }

    .teacher-card .contact .text {
      display: inline-block;
      font-size: .8em;
      margin-left: 5px;
    }
    </style>
  </head>

  <body>
    <div class="templates">
      <div class="ripple"></div>

      <div class="teacher-card">
        <div class="container">
          <div class="image"></div>
          <div class="name"></div>
          <div class="course-names">
          </div>
        </div>
      </div>
      <a class="contact ripple-enabled ripple-gray">
        <i></i>
        <div class="text"></div>
      </a>
    </div>

    <div id="head">
      <div class="text"></div>
    </div>

    <div id="loading-bar">
      <div class="bg"></div>
      <div class="bar-container first"><div class="bar"></div></div>
      <div class="bar-container second"><div class="bar"></div></div>
    </div>

    <div id="content">
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/velocity/1.5.0/velocity.min.js"></script>

    <script>
    // NOTE:
    // - When modifiying anything created from a template, make sure only
    // descendents of the page are selected (ex. '.homepage') to prevent
    // unintentional modification of the template itself

    const constants = {
      title: 'Stevenson Math and Computer Science',
      color: 'indigo', // background color of header
      colors: ['orange', 'blue', 'red', 'green', 'purple', 'teal'], // make sure the corresponding CSS classes are added when adding colors
      pages: { // maintains index of all pages on the website
        courses: { // uses coursepage.html to load the following pages
          loader: loadCourse,
          '#/geometry-honors': {
            name: 'Geometry Honors', // the name is used to obtain the corresponding JSON data file (replace spaces with underscores)
            teachers: ['Christian Thibaudeau', 'Bradley Habel']
          },
          '#/precalc-honors': {
            name: 'Pre-Calc Honors',
            teachers: ['Paul Kim']
          },
          '#/calc-ab': {
            name: 'AP Calculus AB',
            teachers: []
          },
          '#/calc-bc': {
            name: 'AP Calculus BC',
            teachers: ['Christian Thibaudeau', 'Robert Gammelgaard', 'Deborah Wiersema']
          },
          '#/apcsp': {
            name: 'AP Computer Science Principles',
            teachers: ['Steven Svetlik', 'Michelle Zietlow']
          },
          '#/programming': {
            name: 'Computer Programming',
            teachers: ['Todd Sikora']
          }
        }
      },
      teachers: { //TODO: Organize alphabetically
        'Christian Thibaudeau': {
          email: 'cthibaudeau@d125.org',
          phone: 8474154624
        },
        'Paul Kim': {},
        'Robert Gammelgaard': {},
        'Bradley Habel': {},
        'Deborah Wiersema': {},
        'Steven Svetlik': {},
        'Michelle Zietlow': {},
        'Todd Sikora': {}
      },
      animations: { //any durations/delays for animations are stored here for easy modification
        ripple: {
          duration: 300 // the ripple animation on any element with .ripple-enabled lasts for 300 milliseconds
        }
      }
    }

    // initialize course colors
    var i = 0;
    for (var prop in constants.pages.courses) {
      constants.pages.courses[prop].color = constants.colors[i++ % constants.colors.length];
    }

    function slowDownAnimations(amount = 10) { // temporary, for development purposes
      for (var a in constants.animations) {
        for (var b in constants.animations[a]) {
          constants.animations[a][b] *= amount;
        }
      }
    }

    // loads homepage whenever #head is clicked
    $("#head").click(function() {
      location.href = location.origin + location.pathname;
    });

    /**
     * shows or hides the loading bar set to the specified color
     * the color is maintained from any previous color changes
     * Ex. loadingBar(false, 'blue') sets color to blue without displaying loading bar
     *
     * @param  {boolean} show    true - show the loading bar, false - hide the loading bar (does nothing if already shown/hidden)
     * @param  {String} [color]  optionally set the loading bar to one of the colors in constants.colors
     */
    function loadingBar(show, color) {
      if (color) {
        $('#loading-bar .bg').removeClass().addClass('bg'); //remove all classes except bg (remove all previous colors)
        $('#loading-bar .bar').removeClass().addClass('bar'); //remove all classes except bar (remove all previous colors)
        $('#loading-bar .bg, #loading-bar .bar').addClass(color);
      }
      if (show) {
        $('#loading-bar').css('display', 'block');
        $('#loading-bar .bar-container.first').addClass('loading-translate-1');
        $('#loading-bar .bar-container.second').addClass('loading-translate-2');
        $('#loading-bar .first .bar').addClass('loading-scale-1');
        $('#loading-bar .second .bar').addClass('loading-scale-2');
      } else {
        $('#loading-bar .bar-container.first').removeClass('loading-translate-1');
        $('#loading-bar .bar-container.second').removeClass('loading-translate-2');
        $('#loading-bar .first .bar').removeClass('loading-scale-1');
        $('#loading-bar .second .bar').removeClass('loading-scale-2');
        $('#loading-bar').css('display', '');
      }
    }

    // calls the function load when page is ready
    $(function() {
      load();
    });

    // popstate is fired when window's history changes (when back/forward is clicked or when location.href is set)
    // necessary since browser doesn't automatically reload when hash part of url changes
    $(window).on('popstate', function (e) {
      load();
    });

    function initializeRipples($parent) {
      $parent = $parent || $('body');
      $parent.find('.ripple-enabled').click(function(e) {
        // mouse x and y relative to the clicked element instead of the page
        var relX = e.pageX - $(this).offset().left;
        var relY = e.pageY - $(this).offset().top;

        // clones ripple to ensure that a new copy is being used for each click
        var ripple = $(".templates").children(".ripple").clone();

        // adds ripple to clicked element and sets position to click location
        $(this).append(ripple);
        ripple.css({left: relX, top: relY});

        // gets length of twice the diagonal in order for ripple to cover all of the element even if mouse click
        // is in a corner and then divides by ripple's diameter to get appropriate scale amount
        var scaleAmount = Math.sqrt(Math.pow($(this).outerHeight(), 2) + Math.pow($(this).outerWidth(), 2)) * 2 / ripple.width();
        ripple.css({'transform': 'scale(' + scaleAmount + ')', 'opacity': .2});

        // removes ripple after 300 milliseconds
        setTimeout(function() {
          ripple.remove();
        }, constants.animations.ripple.duration);
      });
    }


    /**
     * loads a page using the specified page
     * if unspecified, uses URL to determine desired page
     *
     * @param  {String} [page]  the hash portion of the URL of desired page (look at keys defined in constants.pages)
     */
    function load(page) {
      //if page is not specified, sets page to the part of URL after #
      page = page || location.hash;

      //Removes everything in #content and all color classes for header
      $('#content > *').remove();
      $('#head').removeClass();

      var loader = false; //loader is a function that is used to load the proper content for each type of page
      for (prop in constants.pages) {
        if (constants.pages[prop][page]) {
          loader = constants.pages[prop].loader; // sets the loader function to the loader for the requested page
          page = constants.pages[prop][page]; //sets page to the page object so the loader doesn't have to refind it if necessary
        }
      }

      // if the loader for a page isn't found, defaults to loading the home page
      if (!loader) {
        loader = loadHome;
      }
      loader(page, function() {
        // ripples need to be initialized after page is completely loaded
        initializeRipples();
      });
    }

    /**
     * loads homepage.html into space below header
     *
     * @param  {Object} data          currently unused parameter for loadHome that may be necessary for other loaders
     * @param  {Function} [callback]  calls this function after loading homepage with the status as a parameter: true if successful
     */
    function loadHome(data, callback) {
      $('#head').addClass(constants.color);
      $('#head .text').text(constants.title);

      loadingBar(true, constants.color);

      // gets homepage.html and loads it into #content
      $.get('homepage.html').done(function(data) {
        $("#content").html(data);
        initializeHome();
        if (callback) callback(true);
      }).fail(function(_, status) {
        console.error('Error loading homepage.html, status="' + status + '"');
        //TODO: show user friendly error message
        if (callback) callback(false);
      }).always(function() {
        loadingBar(false);
      });
    }


    /**
     * loads courspage.html with the data of the desired course
     *
     * @param  {Object} course        the data for the desired course to load (use the objects contained in constants.pages.courses)
     * @param  {Function} [callback]  calls this function after loading coursepage with the status as a parameter: true if successful
     */
    function loadCourse(course, callback) {
      $('#head').addClass(course.color);
      $('#head .text').text(course.name);

      loadingBar(true, course.color);
      // gets coursepage.html and loads it into #content
      $.get('coursepage.html').done(function(data) {
        $("#content").html(data);

        // gets the data for the desired course
        $.get('courses/' + course.name.replace(/ /g, '_') + '.json').done(function(data) {
          data.color = course.color;
          data.name = course.name;
          initializeCourse(data);
          if (callback) callback(true);
        }).fail(function(_, status) {
          console.error('Error loading or parsing courses/' + course.name.replace(/ /g, '_')
                        + '.json, status="' + status + '"');
          //TODO: show user friendly error page
          if (callback) callback(false);
        }).always(function() {
          loadingBar(false);
        });

      }).fail(function(_, status) {
        console.error('Error loading coursepage.html, status = "' + status + '"');
        loadingBar(false);
        //TODO: show user friendly error page
        if(callback) callback(false);
      });
    }

    function createTeacherCard(teacherName, color) {
      var $card = $('.templates').children('.teacher-card').clone();
      $card.find('.image').css('background-image', 'url("pictures/'
        + (constants.teachers[teacherName].picture || color + '.jpg') + '")');
      $card.find('.name').text(teacherName);

      // finds each course taught by teacher and adds them to the card
      for (var prop in constants.pages.courses) {
        var course = constants.pages.courses[prop];
        if(course.teachers && course.teachers.indexOf(teacherName) > -1) {
          $card.find('.course-names').append('<div>' + course.name + '</div');
        }
      }

      // adds contact information based on what is specified in the data
      // email, phone number supported so far
      if(constants.teachers[teacherName]) {
        var contactOptions = [{
          value: constants.teachers[teacherName].email,
          icon: 'fa fa-envelope',
          href: 'mailto:' + constants.teachers[teacherName].email
        }, {
          value: constants.teachers[teacherName].phone,
          icon: 'fa fa-phone',
          href: 'tel:' + constants.teachers[teacherName].phone,
          format: function(phone) {
            return '(' + phone.slice(0, 3) + ') ' + phone.slice(3, 6) + '-' + phone.slice(6, 10);
          }
        }];
        contactOptions.forEach(function(contact) {
          if(contact.value) {
            var value = contact.value + ''; //convert to string
            var $contact = $('.templates').children('.contact').clone();
            $contact.children('i').addClass(contact.icon).addClass(color + '-text');
            $contact.attr('href', contact.href);
            var text = contact.format? contact.format(value) : value;
            $contact.children('.text').text(text);
            $card.children('.container').append($contact);
          }
        });
      }
      initializeRipples($card);

      return $card;
    }

    function log() { // temporary, for development purposes
      console.log(Array.from(arguments).reduce((str, item) => str + item + ' ', ''));
      if(arguments.length == 1) return arguments[0];
    }
    </script>
  </body>
</html>
